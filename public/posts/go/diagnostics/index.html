<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>How to profile Golang Program :: Terminal</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="First of all, this document is in progress and will keep updated.
Diagnostic by the http call is usually a convinient way in pratice. What we need to do is only two steps before starting the program:
import _ &amp;quot;net/http/pprof&amp;quot; http.ListenAndServe(&amp;quot;the address that defined in advance&amp;quot;, better use privaty ServerMux instead of the default one) Profile The port 6060 is an example that defined for the http listening. The default time is 30s that go pprof will collect the samples which used to profile without the specificatoin." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/go/diagnostics/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How to profile Golang Program :: Terminal">
<meta property="og:description" content="Breif indroduction of how to use the go tools to diagnose" />
<meta property="og:url" content="/posts/go/diagnostics/" />
<meta property="og:site_name" content="How to profile Golang Program" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-11-30 08:35:51 &#43;0800 &#43;08" />












</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    jinying-che
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/posts">Home</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts">Home</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/go/diagnostics/">How to profile Golang Program</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2020-11-30 
      </span>
    
    
  </div>

  

  

  

  <div class="post-content"><div>
        <p>First of all, this document is in progress and will keep updated.</p>
<p>Diagnostic by the http call is usually a convinient way in pratice. What we need to do is only two steps before starting the program:</p>
<blockquote>
<ul>
<li><code>import _ &quot;net/http/pprof&quot;</code></li>
<li><code>http.ListenAndServe(&quot;the address that defined in advance&quot;, better use privaty ServerMux instead of the default one)</code></li>
</ul>
</blockquote>
<h2 id="profile">Profile<a href="#profile" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The port 6060 is an example that defined for the http listening. The default time is 30s that go pprof will collect the samples which used to profile without the specificatoin.(I have not find the way to specify btw)</p>
<ul>
<li>http://localhost:6060/debug/pprof/goroutine</li>
<li>http://localhost:6060/debug/pprof/heap</li>
<li>http://localhost:6060/debug/pprof/threadcreate</li>
<li>http://localhost:6060/debug/pprof/block</li>
<li>http://localhost:6060/debug/pprof/mutex</li>
<li>http://localhost:6060/debug/pprof/profile</li>
</ul>
<p>Here is a demo of the profilling.</p>
<ul>
<li>trigger:</li>
</ul>
<blockquote>
<p><code>curl localhost:6060/debug/pprof/profile &gt; profile.pprof</code> (the filename can arbitrary)</p>
</blockquote>
<ul>
<li>analyse:</li>
</ul>
<blockquote>
<p><code>go tool pprof -http :6060 ./profile.pprof</code></p>
</blockquote>
<h2 id="trace">Trace<a href="#trace" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li>http://localhost:6060/debug/pprof/trace</li>
</ul>
<p>Here is a demo of the trace.</p>
<ul>
<li>trigger:</li>
</ul>
<blockquote>
<p><code>curl localhost:6060/debug/pprof/trace &gt; profile.trace</code></p>
</blockquote>
<ul>
<li>analyse:</li>
</ul>
<blockquote>
<p><code>go tool trace -http :6060 ./profile.trace</code></p>
</blockquote>
<hr>
<h2 id="ref">Ref<a href="#ref" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<ul>
<li><a href="https://github.com/google/pprof">https://github.com/google/pprof</a></li>
<li><a href="https://golang.org/doc/diagnostics.html">https://golang.org/doc/diagnostics.html</a></li>
<li><a href="https://golang.org/pkg/runtime/pprof/">https://golang.org/pkg/runtime/pprof/</a></li>
<li><a href="https://jvns.ca/blog/2017/09/24/profiling-go-with-pprof/">https://jvns.ca/blog/2017/09/24/profiling-go-with-pprof/</a></li>
</ul>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/posts/c/ctags/">
                <span class="button__icon">←</span>
                <span class="button__text">Setup Universal Ctags for Mac</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/posts/go/ratelimiter/">
                <span class="button__text">How does golang implement the Rate Limiter</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
