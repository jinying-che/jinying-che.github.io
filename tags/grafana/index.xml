<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Grafana on</title><link>https://chejinying.com/tech/tags/grafana/</link><description>Recent content in Grafana on</description><generator>Hugo</generator><language>en</language><lastBuildDate>Sun, 24 Nov 2024 16:19:22 +0800</lastBuildDate><atom:link href="https://chejinying.com/tech/tags/grafana/index.xml" rel="self" type="application/rss+xml"/><item><title>alerting rule: grafana vs vmalert</title><link>https://chejinying.com/tech/posts/alerting_rule_grafana_vs_vmalert/</link><pubDate>Sun, 24 Nov 2024 16:19:22 +0800</pubDate><guid>https://chejinying.com/tech/posts/alerting_rule_grafana_vs_vmalert/</guid><description>&lt;p&gt;Let&amp;rsquo;s try to understand how alerting rule is implemented in two open source projects: &lt;strong&gt;grafana&lt;/strong&gt; and &lt;strong&gt;vmalert&lt;/strong&gt;.&lt;/p&gt;
&lt;h1 id="version"&gt;Version&lt;/h1&gt;
&lt;p&gt;use the latest version of the according source code:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;grafana &lt;a href="https://github.com/grafana/grafana/tree/v11.3.1"&gt;v11.3.1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;vmalert &lt;a href="https://github.com/VictoriaMetrics/VictoriaMetrics/tree/v1.106.1"&gt;v1.106.1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="flow"&gt;Flow&lt;/h1&gt;
&lt;h3 id="grafana"&gt;grafana&lt;/h3&gt;
&lt;p&gt;&lt;img src="https://chejinying.com/tech/images/grafana_alert.png" alt="grafana alert"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Scheduler -&amp;gt; fetch alerting rules -&amp;gt; start &lt;em&gt;goroutine&lt;/em&gt; for each alerting rule
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pkg/services/ngalert/schedule/schedule.go:280&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Scheduler -&amp;gt; send evaluation event(when internal elapsed) -&amp;gt; goroutine -&amp;gt; evaluation
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pkg/services/ngalert/schedule/alert_rule.go:242&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Schedduler -&amp;gt; stop the goroutine (alerting rule delted) according to the heartbeat
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pkg/services/ngalert/schedule/alert_rule.go:355&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="vmalert"&gt;vmalert&lt;/h3&gt;
&lt;p&gt;&lt;img src="https://chejinying.com/tech/images/vmalert.png" alt="vmalert"&gt;&lt;/p&gt;</description></item></channel></rss>